üöÄ Bosun IoT Integration (Python)
‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Bosun IoT Platform ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° (Control) ‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ (Monitor) ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÇ‡∏Ñ‡∏°‡πÑ‡∏ü‡∏ñ‡∏ô‡∏ô‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏ö‡∏ö Hybrid Authentication ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á API
============
üìã System Architecture
‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å Bosun ‡πÅ‡∏¢‡∏Å Server ‡πÅ‡∏•‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Authentication 2 ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô:
Feature Method Endpoint Auth Type Stability

Monitor
(Read) Enterprise API open.smartbosun.com RSA Key (Auto-Renew) ‚≠ê Stable (Lifetime)

Control
(Write) Browser Mimic light.smartbosun.com Browser Token ‚ö†Ô∏è Expire yearly
============
Workflow ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å (main_monitor.py):

1. Poke: ‡∏™‡∏±‡πà‡∏á Force Refresh ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå (‡πÉ‡∏ä‡πâ Browser Token)
2. Wait: ‡∏£‡∏≠ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Server ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
3. Read: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ú‡πà‡∏≤‡∏ô Enterprise API (‡πÉ‡∏ä‡πâ RSA Token)
4. # Log: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á CSV
   üìÇ Project StructurePlaintext.
   ‚îú‚îÄ‚îÄ config/
   ‚îÇ ‚îú‚îÄ‚îÄ private_key.pem # üîê RSA Private Key (‡∏´‡πâ‡∏≤‡∏° commit ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ!)
   ‚îÇ ‚îî‚îÄ‚îÄ token_cache.json # Auto-generated by system
   ‚îú‚îÄ‚îÄ logs/
   ‚îÇ ‚îî‚îÄ‚îÄ bosun_data.csv # Output log file
   ‚îú‚îÄ‚îÄ bs_auth.py # [Core] Auth Manager (RSA & Auto-renew)
   ‚îú‚îÄ‚îÄ bs_decoder.py # [Core] Data Decoder (Logic v13)
   ‚îú‚îÄ‚îÄ bs_controller_with_auth.py # [Core] Control Command (ON/OFF/Refresh)
   ‚îî‚îÄ‚îÄ main_monitor.py # [Main] Script ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
   ============
   üõ†Ô∏è Installation & Setup
5. Clone Repository
6. Install Dependencies

Bashpip install requests cryptography

3. Setup Keys
   ‚Ä¢ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå config/
   ‚Ä¢ ‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå private_key.pem (‡∏à‡∏≤‡∏Å Supplier) ‡∏•‡∏á‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ
   ============
   üöÄ Usage
1. ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Monitor (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ß‡∏ô‡∏•‡∏π‡∏õ: ‡∏™‡∏±‡πà‡∏á Refresh -> ‡∏£‡∏≠ -> ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ -> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å Log (‡∏ó‡∏∏‡∏Å 10 ‡∏ô‡∏≤‡∏ó‡∏µ)

Bashpython3 main_monitor.py

2.  ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Module ‡πÅ‡∏¢‡∏Å (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Dev ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î)
    ‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ (Decoder):
    Python
    import bs_decoder as decoder

# ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ñ‡∏≠‡∏î‡∏£‡∏´‡∏±‡∏™

device = decoder.get_device_data()
hex_str = decoder.extract_hex(device)
data = decoder.decode_final(hex_str)

## print(f"Power: {data['power_w']} W")

‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô (Controller):Pythonimport bs_controller_with_auth as ctrl

ctrl.send_turn_on() # ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü
ctrl.send_turn_off() # ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü
ctrl.send_refresh() # ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
============
‚ö†Ô∏è Maintenance (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å)
Token ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå bs_controller_with_auth.py ‡∏°‡∏µ‡∏≠‡∏≤‡∏¢‡∏∏‡∏à‡∏≥‡∏Å‡∏±‡∏î (Browser Session)¬∞\

    ‚Ä¢ Current Token Expiry: 30 ‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô 2025
    ‚Ä¢ ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏: ‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ, Log ‡∏Ç‡∏∂‡πâ‡∏ô Error 401

‡∏ß‡∏¥‡∏ò‡∏µ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Token:

1. Login ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö Bosun Dashboard‡∏Å‡∏î
2. F12 -> Tab Network
3. ‡∏Å‡∏î‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏î‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö
4. ‡∏´‡∏≤ Request ‡∏ä‡∏∑‡πà‡∏≠ mqtt -> ‡∏î‡∏π Request Headers
5. Copy ‡∏Ñ‡πà‡∏≤ Authorization: Bearer <TOKEN>
6. # ‡∏ô‡∏≥‡πÑ‡∏õ‡∏ß‡∏≤‡∏á‡∏ó‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ BROWSER_TOKEN ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå bs_controller_with_auth.py
   üìä Decoder Specification (v13)
   ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Hex String (‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏î Header 6 ‡∏ï‡∏±‡∏ß‡πÅ‡∏£‡∏Å:
   Parameter Pos Divisor Unit
   Current 4 100 A
   Voltage 20 10 V
   Frequency 28 100 Hz
   Active Power36 100 W
   Power Factor100 100 PF
   Energy 60 1000 kWh
   Temperature 264 100 ¬∞C
   Humidity 268 100 %
